<div class="container">
  <div class="sidebar">
    <h1>üñäÔ∏è Pen Tool (Angular)</h1>

    <div class="section">
      <div class="section-title">Status</div>
      <div class="info">
        Mode: <span class="state-indicator">{{ mode().toUpperCase() }}</span>
        <br />
        State: <span class="state-indicator">{{ toolState() }}</span>
      </div>
    </div>

    <div class="section">
      <div class="section-title">Actions</div>
      <button class="button" (click)="toggleMode()">
        {{ getToggleModeText() }}
      </button>
      <button class="button secondary" (click)="clearAllPaths()">
        Clear All Paths
      </button>
      <button
        class="button secondary"
        (click)="closeCurrentPath()"
        [disabled]="!canClosePath()"
      >
        Close Current Path
      </button>
    </div>

    <div class="section">
      <div class="section-title">Path Statistics</div>
      <div class="info">
        Paths: <strong>{{ pathCount() }}</strong
        ><br />
        <ng-container *ngIf="currentPath()">
          Current points:
          <strong>{{ currentPath()!.anchorPoints.length }}</strong
          ><br />
          Path closed:
          <strong>{{ currentPath()!.closed ? "Yes" : "No" }}</strong>
        </ng-container>
        <ng-container *ngIf="selectedPoints().length > 0">
          <br />Selected points: <strong>{{ selectedPoints().length }}</strong>
        </ng-container>
      </div>
    </div>

    <div class="section">
      <div class="section-title">Instructions</div>
      <div class="info">
        <strong>Drawing Mode:</strong><br />
        ‚Ä¢ Click to add straight points<br />
        ‚Ä¢ Click & drag to create curves<br />
        ‚Ä¢ Hold <span class="key">Shift</span> to constrain angles<br />
        ‚Ä¢ Hold <span class="key">Alt</span> for independent handles<br />
        ‚Ä¢ Click on first point to close path<br />
        <br />
        <strong>Edit Mode:</strong><br />
        ‚Ä¢ Click & drag anchor points to move<br />
        ‚Ä¢ Click & drag handles to adjust curves<br />
        ‚Ä¢ Hold <span class="key">Alt</span> while dragging handles for
        independent control<br />
        ‚Ä¢ Double-click on path to add points<br />
        ‚Ä¢ Select points and press <span class="key">Delete</span> to remove<br />
        <br />
        <strong>View Mode:</strong><br />
        ‚Ä¢ See paths without any interactive elements
      </div>
    </div>

    <div class="section">
      <div class="section-title">Keyboard Shortcuts</div>
      <div class="keyboard-shortcuts">
        <div class="shortcut">
          <span>Constrain angle</span>
          <span class="key">Shift</span>
        </div>
        <div class="shortcut">
          <span>Independent handles</span>
          <span class="key">Alt</span>
        </div>
        <div class="shortcut">
          <span>Close path</span>
          <span class="key">Enter</span>
        </div>
        <div class="shortcut">
          <span>Finish path</span>
          <span class="key">Esc</span>
        </div>
        <div class="shortcut">
          <span>Delete point</span>
          <span class="key">Delete</span>
        </div>
      </div>
    </div>

  </div>

  <div class="canvas-container">
    <svg
      #canvas
      width="800"
      height="600"
      [style.cursor]="mode() === 'pen' ? 'crosshair' : 'default'"
      (mousedown)="onMouseDown($event)"
      (mousemove)="onMouseMove($event)"
      (mouseup)="onMouseUp($event)"
      (dblclick)="onDoubleClick($event)"
    ></svg>
  </div>

  <div class="sidebar right-sidebar">
    <h1>üìã Paths</h1>

    <div class="section">
      <div class="section-title">All Paths ({{ paths().length }})</div>
      <div class="paths-list">
        @if (paths().length === 0) {
          <div class="info">No paths drawn yet. Start drawing!</div>
        } @else {
          @for (pathInfo of paths(); track pathInfo.id) {
            <div class="path-item">
              <div class="path-header">
                <strong>Path {{ $index + 1 }}</strong>
                <span class="badge">{{ pathInfo.pointCount }} points</span>
                @if (pathInfo.closed) {
                  <span class="badge closed">Closed</span>
                }
              </div>
              <div class="path-data">
                <code>{{ pathInfo.svgPath }}</code>
              </div>
            </div>
          }
        }
      </div>
    </div>
  </div>
</div>
